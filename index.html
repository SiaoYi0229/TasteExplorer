<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>TasteExplorer - 美味探索</title>
    <link rel="icon" href="favicon.png" type="image/png">
    <link rel="apple-touch-icon" href="favicon.png">
    <style>
        /* --- 1. 核心樣式：100% 還原配色與寬度 --- */
        :root {
            --primary-orange: #FF6600;
            --glass-bg: rgba(25, 25, 25, 0.85);
            --glass-border: rgba(255, 255, 255, 0.15);
            --input-bg: rgba(255, 255, 255, 0.1);
            --text-color: #ffffff;
            --label-color: #cccccc;
            --accent-yellow: #FFCC00;
        }

        html, body { overscroll-behavior-y: none; height: 100%; overflow: hidden; position: fixed; width: 100%; margin: 0; padding: 0; background-color: #000; }
        html { font-size: 14px; } 
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-family: -apple-system, "SF Pro Text", "Helvetica Neue", sans-serif; }
        body { color: #fff; display: flex; align-items: center; justify-content: center; }

        #bg-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; }
        .bg-slide { position: absolute; width: 100%; height: 100%; background-size: cover; background-position: center; opacity: 0; transition: opacity 1s; }
        .bg-slide.active { opacity: 0.6; }

        /* --- 2. API 設定頁面 --- */
        #api-overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.5); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); 
            z-index: 5000; display: none; flex-direction: column; align-items: center; justify-content: center; 
            padding: 40px 20px; text-align: center; 
        }
        .api-card { width: 100%; max-width: 340px; background: rgba(20, 20, 20, 0.8); border: 1px solid var(--glass-border); border-radius: 24px; padding: 30px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        .api-input { width: 100%; background: var(--input-bg); border: 1px solid var(--glass-border); border-radius: 12px; padding: 15px; color: white; font-size: 1rem; margin-bottom: 15px; text-align: center; }
        .api-save-btn { width: 100%; background: var(--primary-orange); color: white; border: none; padding: 14px; border-radius: 12px; font-weight: bold; cursor: pointer; }

        /* --- 3. 佈局結構：三段式平均分配 --- */
        .container { 
            width: 95%; max-width: 357px; height: 100dvh; z-index: 10; 
            display: flex; flex-direction: column; 
            justify-content: space-evenly; /* 確保頂、中、底三組完美平均間隔 */
            align-items: center; padding: 10px 0; position: relative; 
        }
        .container.blur-mode { filter: blur(15px) brightness(0.4); transform: scale(0.95); pointer-events: none; }

        .header { width: 100%; flex: 0 0 auto; display: flex; flex-direction: column; align-items: center; position: relative; }
        .logo { font-size: 2.77rem; font-weight: 800; color: var(--primary-orange); line-height: 1.1; letter-spacing: -1px; margin: 0; }
        .tagline { font-size: 1.2rem; color: #ffffff; opacity: 0.8; margin-top: 6px; }
        .settings-btn { position: absolute; top: 0; right: 0; height: 3rem; display: flex; align-items: center; font-size: 24px; cursor: pointer; z-index: 50; padding: 0 5px; }

        /* --- 4. 玻璃卡片：座標按鈕 100% 整合在此框內 --- */
        .glass-card { 
            width: 100%; background: rgba(20, 20, 20, 0.75); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); 
            border-radius: 24px; padding: 18px; border: 1px solid var(--glass-border); 
            flex: 0 0 auto; display: flex; flex-direction: column; gap: 12px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        /* 座標按鈕：平常統一為灰色背景 (與 select 同色系) */
        .location-status {
            width: 100%; font-size: 0.8rem; color: #fff; background: var(--input-bg); 
            padding: 12px; border-radius: 12px; display: flex; align-items: center; justify-content: center; gap: 8px;
            border: 1px solid transparent; cursor: pointer; transition: 0.3s; margin-bottom: 5px;
        }
        /* 按下後變黃色高亮 */
        .location-status.active-mode { 
            background: rgba(255, 204, 0, 0.15) !important; color: var(--accent-yellow) !important;
            border-color: rgba(255, 204, 0, 0.4); box-shadow: 0 0 15px rgba(255, 204, 0, 0.1); 
        }
        .location-dot { width: 8px; height: 8px; background: #2ecc71; border-radius: 50%; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(46, 204, 113, 0.7); } 70% { transform: scale(1); box-shadow: 0 0 0 6px rgba(46, 204, 113, 0); } 100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(46, 204, 113, 0); } }

        .hide-field { display: none !important; }

        /* 原版表單樣式 100% */
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .full-width { grid-column: span 2; }
        label { font-size: 0.75rem; color: #ffffff; margin-bottom: 4px; display: block; font-weight: 600; }
        .input-box { background: var(--input-bg); border-radius: 10px; height: 38px; display: flex; align-items: center; padding: 0 10px; border: 1px solid transparent; transition: 0.3s; }
        .input-box:focus-within { border-color: var(--primary-orange); box-shadow: 0 0 8px rgba(255, 102, 0, 0.3); }
        select { background: transparent; border: none; color: white; width: 100%; outline: none; font-size: 0.85rem; appearance: none; -webkit-appearance: none; cursor: pointer; }
        select option { background-color: #222; }

        .toggle-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 4px; }
        .toggle-btn { background: var(--input-bg); height: 40px; border-radius: 10px; display: flex; align-items: center; justify-content: center; cursor: pointer; border: 1px solid transparent; font-size: 0.85rem; transition: 0.3s; }
        .toggle-btn.selected { background: rgba(255,102,0,0.2); border-color: var(--primary-orange); color: var(--primary-orange); font-weight: bold; }
        #btn-open.selected { background: rgba(46,204,113,0.15); border-color: #2ecc71; color: #2ecc71; }

        /* Group 3: 底部組 --- */
        .footer-action { width: 100%;
